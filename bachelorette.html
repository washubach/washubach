<!DOCTYPE html>
<html>
<head>

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-54R037LJ0D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-54R037LJ0D');
</script>
    
    <title>Class of 2020's Most Eligible Bachelorette</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        /* --- Copied Optimized Styles from Bachelor HTML --- */
        /* Base styles */
        body {
            font-family: sans-serif;
            padding: 15px; /* Slightly reduced padding */
            max-width: 600px; /* Max width on larger screens */
            margin: 15px auto; /* Centering and top/bottom margin */
            background-color: #f8f8f8; /* Optional background */
            box-sizing: border-box; /* Include padding in width calculation */
        }
        #poll-container div.poll-item {
            margin-bottom: 10px;
            padding: 10px; /* Slightly increased padding for easier tapping */
            border: 1px solid #ccc;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fff; /* Give items a background */
            flex-wrap: wrap; /* Allow wrapping on very small screens if needed */
        }
        #poll-container div.poll-item span.item-text {
            margin-right: auto;
            padding-right: 10px; /* Reduced padding */
            /* Allow text to wrap */
            word-break: break-word;
            flex-grow: 1; /* Allow text to take available space */
        }
        #poll-container div.poll-item div { /* Container for buttons */
            flex-shrink: 0; /* Prevent button container from shrinking too much */
        }

        /* General Button Style */
        button, a.nav-button {
            margin-left: 5px;
            padding: 6px 12px; /* Slightly larger tap target */
            cursor: pointer;
            background-color: #eee;
            border: 1px solid #aaa;
            border-radius: 3px;
            text-decoration: none;
            color: #333;
            display: inline-block;
            font-size: 0.95em; /* Adjust font size */
            white-space: nowrap; /* Prevent button text wrapping */
        }
        button:hover:not(:disabled), a.nav-button:hover {
             background-color: #ddd;
        }
        button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        input[type="text"] {
            padding: 8px; /* Easier tapping */
            margin-right: 5px;
            border: 1px solid #aaa;
            border-radius: 3px;
            flex-grow: 1;
            min-width: 100px;
            box-sizing: border-box;
        }

        .add-section {
             margin-top: 20px;
             padding-top: 15px;
             border-top: 1px solid #eee;
             display: flex;
             flex-wrap: wrap;
             align-items: center;
             gap: 10px;
        }
        .add-section button {
            flex-shrink: 0;
        }

        .status-message {
            width: 100%;
            text-align: center;
            margin-left: 0;
            margin-top: 5px;
            font-style: italic;
            font-size: 0.9em;
        }

        .error-message { color: #D8000C; background-color: #FFD2D2; border: 1px solid #D8000C; padding: 10px; border-radius: 4px; margin-bottom: 15px; }
        .error-details { color: #A00000; background-color: #FDD; border: 1px solid #A00000; padding: 10px; margin-top: 10px; white-space: pre-wrap; word-break: break-all; font-family: monospace; font-size: 0.9em; }
        hr { display: none; }
        #loading-indicator { font-style: italic; color: #555; }

        /* Navigation Buttons */
        .navigation-buttons {
            text-align: right;
            margin-bottom: 15px;
            padding: 5px 0;
        }
        .nav-button { margin-left: 10px; }


        /* --- ADDED: Media Query for Smaller Screens (e.g., phones) --- */
        @media (max-width: 600px) {
            body {
                padding: 10px;
                margin-top: 10px;
                margin-bottom: 10px;
                font-size: 16px;
            }

            h1 {
                font-size: 1.5em;
            }

             .navigation-buttons {
                text-align: center;
             }
             .nav-button {
                 margin: 5px;
             }

            #poll-container div.poll-item {
                flex-direction: column;
                align-items: stretch;
                padding: 12px;
            }
            #poll-container div.poll-item span.item-text {
                margin-bottom: 10px;
                padding-right: 0;
                text-align: center;
            }
             #poll-container div.poll-item div { /* Button container */
                 text-align: center;
                 width: 100%;
            }

             .add-section {
                flex-direction: column;
                align-items: stretch;
             }
             .add-section input[type="text"] {
                margin-right: 0;
                margin-bottom: 10px;
                width: 100%;
             }
             .add-section button {
                 margin-left: 0;
             }
             .add-section .status-message { /* Already handled by width: 100% */ }
        }
        /* --- END Media Query --- */
        /* --- END Copied Styles --- */

    </style>
</head>
<body>

    <div class="navigation-buttons">
        <a href="index.html" class="nav-button">Home</a>
        <a href="bachelor.html" class="nav-button">Bachelor</a>
    </div>

    <h1>Class of 2020's Most Eligible Bachelorette</h1>
    <p style="font-size: 0.9em; color: #333;">I used AI and don't actually code, so please forgive the slow loading time and shitty UI, especially on mobile.</p>
    <p style="font-size: 0.9em; color: #333;">Also, just saying, it would be really awesome if the top people ACTUALLY went on a date. What if you got married off a website that was built in like two hours? Pretty good story. Do it for the bit.</p>
    <p style="font-size: 0.9em; color: #333;">Names are sorted by highest upvotes. You can only upvote each name once. Please add new entries as you see fit - that will also give them an upvote (please don't add people you know are taken).</p>

    <div id="poll-container">
        <p id="loading-indicator">Give it a sec...</p> </div>

    <div class="add-section">
        <input type="text" id="newName" placeholder="Beauty & Grace">
        <button onclick="addNewNameToPoll()">Add Bachelorette</button>
         <span id="add-status" class="status-message"></span>
    </div>

    <script>
        // --- Configuration ---
        const webAppUrl = "https://script.google.com/macros/s/AKfycbyq_WFXfVJ-q-mJHlPpI3xRTO97Vh9eZEHhMFF2Dywc1cmkOWxF9n1cufdV06EYcbZG/exec"; // Same URL
        // *** CHANGED: Point to Bachelorette Sheet ***
        const currentSheetName = "Bachelorette";
        // *** CHANGED: Use a different key for Bachelorette votes ***
        const VOTE_STORAGE_KEY = 'bachelorettePollVotes';

        // --- DOM Elements ---
        const pollContainer = document.getElementById("poll-container");
        const nameInput = document.getElementById("newName");
        const addStatusSpan = document.getElementById("add-status");
        const loadingIndicator = document.getElementById("loading-indicator");

        // --- Local Storage Helpers (Identical Logic) ---
        function getVotedNames() { try { const d = localStorage.getItem(VOTE_STORAGE_KEY); if (d) { const p = JSON.parse(d); if (typeof p === 'object' && p !== null && !Array.isArray(p)) { return p; } } } catch (e) { console.error("Err LStorage:", e); } return {}; }
        function markNameAsVoted(name) { if (!name) return; try { const v = getVotedNames(); v[name] = true; localStorage.setItem(VOTE_STORAGE_KEY, JSON.stringify(v)); console.log(`Stored ${name}`); } catch (e) { console.error(`Err saving ${name}:`, e); } }

        // --- Fetching and Displaying Data (Identical Logic) ---
        async function fetchData(sheetName) { console.log("Fetching:", `${webAppUrl}?action=getData&sheetName=${sheetName}`); let d = null; try { const r = await fetch(`${webAppUrl}?action=getData&sheetName=${sheetName}`); console.log("Status:", r.status); if (!r.ok) { const t = await r.text(); throw new Error(`HTTP err! ${r.status}`); } d = await r.json(); console.log("Received:", d); if (d && d.error) { throw new Error("Server err: " + d.error); } if (!Array.isArray(d)) { throw new Error("Invalid format: Expected array"); } return d; } catch (e) { console.error("Err fetch:", e); let h = `<span class="error-message">${e.message}</span>`; let de = false; if (e.message.startsWith("Invalid") && d) { h += `<br><strong>Data:</strong><div class="error-details">${JSON.stringify(d, null, 2)}</div>`; de = true; } else if (e.message.startsWith("Server") && d) { h += `<br><strong>Err Obj:</strong><div class="error-details">${JSON.stringify(d, null, 2)}</div>`; de = true; } else if (!e.message.startsWith("Server") && d && typeof d === 'object') { h += `<br><strong>Data:</strong><div class="error-details">${JSON.stringify(d, null, 2)}</div>`; de = true; } if (!de) { h += '<br><span style="font-size:0.9em;font-style:italic;">Check console/logs.</span>'; } pollContainer.innerHTML = `<div class="error-message">${h}</div>`; return null; } }

        // --- Load Poll (Rendering Logic - Updated to remove Downvotes) ---
        async function loadPoll(sheetName) {
            loadingIndicator.style.display = 'block'; pollContainer.innerHTML = ''; pollContainer.appendChild(loadingIndicator);
            const data = await fetchData(sheetName);
            loadingIndicator.style.display = 'none'; if (data === null) return;
            pollContainer.innerHTML = ""; if (data.length === 0) { pollContainer.innerHTML = "<p>No names added to the poll yet.</p>"; return; }

            data.sort((a, b) => (Number(b.Upvotes) || 0) - (Number(a.Upvotes) || 0));
            const votedNames = getVotedNames();

            data.forEach(item => {
                if (item && typeof item === 'object' && 'Name' in item) {
                    const itemDiv = document.createElement("div"); itemDiv.className = 'poll-item';
                    const upvotes = Number(item.Upvotes) || 0; const encodedName = encodeURIComponent(item.Name); const displayName = item.Name;
                    const isAlreadyUpvoted = votedNames[displayName] === true; const upvoteButtonDisabled = isAlreadyUpvoted ? 'disabled' : '';
                    const upvoteButtonText = isAlreadyUpvoted ? '✅ Voted' : '⬆️ Upvote';
                    const upvoteTooltip = isAlreadyUpvoted ? `You already upvoted ${displayName}` : `Upvote ${displayName}`;

                    // --- Displays Upvotes only ---
                    itemDiv.innerHTML = `
                        <span class="item-text">
                            <strong>${displayName}</strong> &nbsp;|&nbsp; Upvotes: ${upvotes}
                        </span>
                        <div>
                            <button title="${upvoteTooltip}" onclick="updateVoteOnPoll('${sheetName}', '${encodedName}', 'upvote', this)" ${upvoteButtonDisabled}>${upvoteButtonText}</button>
                            </div>`;
                    pollContainer.appendChild(itemDiv);
                } else { console.warn("Skip:", item); }
            });
            console.log("Poll updated.");
        }

        // --- Adding and Updating Data (Identical Logic, uses currentSheetName) ---
        async function addNewNameToPoll() {
            const name = nameInput.value.trim(); addStatusSpan.textContent = ""; addStatusSpan.style.color = "";
            // *** CHANGED: Alert text specific to Bachelorette ***
            if (!name) { alert("Please enter an eligible bachelorette"); return; }
            const addButton = nameInput.nextElementSibling; addButton.disabled = true;
            addStatusSpan.textContent = "Adding..."; addStatusSpan.style.color = "orange";
            try {
                const encodedName = encodeURIComponent(name);
                // Uses currentSheetName which is "Bachelorette" for this file
                const r = await fetch(`${webAppUrl}?action=addData&sheetName=${currentSheetName}&name=${encodedName}`);
                if (!r.ok) { const t = await r.text(); throw new Error(`HTTP err! ${r.status}`); }
                const result = await r.json(); console.log("Add Res:", result);
                if (result.success) {
                    nameInput.value = "";
                    addStatusSpan.textContent = "Oh, that's a good add"; // Your text
                    addStatusSpan.style.color = "green";
                    markNameAsVoted(name); await loadPoll(currentSheetName);
                } else { addStatusSpan.textContent = "Error: " + (result.message || result.error || "Could not add."); addStatusSpan.style.color = "red"; }
            } catch (e) { console.error("Err add:", e); addStatusSpan.textContent = "Error adding. Check console."; addStatusSpan.style.color = "red"; }
            finally { addButton.disabled = false; setTimeout(() => { addStatusSpan.textContent = ""; addStatusSpan.style.color = ""; }, 4000); }
        }

        async function updateVoteOnPoll(sheetName, encodedName, voteType, buttonElement) {
            // (Identical logic to bachelor.html version)
            const name = decodeURIComponent(encodedName); console.log(`Update ${voteType} for: ${name}`); if (voteType !== 'upvote') { console.log(`Ignore: ${voteType}`); return; }
            const votedNames = getVotedNames(); if (votedNames[name] === true) { alert(`You have already upvoted "${name}".`); return; } // Your text
            const itemDiv = buttonElement.closest('.poll-item'); const btns = itemDiv ? itemDiv.querySelectorAll('button') : []; btns.forEach(b => b.disabled = true);
            try {
                const r = await fetch(`${webAppUrl}?action=updateVote&sheetName=${sheetName}&name=${encodedName}&voteType=upvote`);
                if (!r.ok) { const t = await r.text(); throw new Error(`HTTP err! ${r.status}`); }
                const result = await r.json(); console.log("Update Res:", result);
                if (result.success) { markNameAsVoted(name); await loadPoll(sheetName); }
                else { alert("Error vote: " + (result.error || "Unknown")); btns.forEach(b => b.disabled = false); }
            } catch (e) { console.error("Err vote:", e); alert("Failed vote. Check console."); btns.forEach(b => b.disabled = false); }
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => { loadPoll(currentSheetName); });
    </script>
</body>
</html>
